<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Researcher Profile - Academic Network</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('main.home') }}">
                <i class="fas fa-graduation-cap"></i> Research'D
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('main.home') }}">
                            <i class="fas fa-home"></i> Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('main.search') }}">
                            <i class="fas fa-search"></i> Search
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="{{ url_for('main.profile') }}">
                            <i class="fas fa-user"></i> Profile
                        </a>
                    </li>
                </ul>
                
                <div class="navbar-nav">
                    <!-- Authentication buttons - shown when not logged in -->
                    <div class="auth-buttons" id="auth-buttons">
                        <a href="{{ url_for('auth.login') }}" class="btn btn-outline-light btn-sm me-2">
                            <i class="fas fa-sign-in-alt"></i> Sign In
                        </a>
                        <a href="{{ url_for('auth.register') }}" class="btn btn-light btn-sm">
                            <i class="fas fa-user-plus"></i> Register
                        </a>
                    </div>
                    
                    <!-- User menu - shown when logged in -->
                    <div class="user-menu d-none" id="user-menu">
                        <div class="dropdown">
                            <button class="btn btn-outline-light dropdown-toggle" type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-user-circle"></i> <span id="username">User</span>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                                <li><a class="dropdown-item" href="{{ url_for('main.home') }}"><i class="fas fa-home"></i> Home</a></li>
                                <li><a class="dropdown-item" href="{{ url_for('main.search') }}"><i class="fas fa-search"></i> Search Researchers</a></li>
                                <li><a class="dropdown-item" href="{{ url_for('main.help') }}"><i class="fas fa-question-circle"></i> Help Centre</a></li>
                                <li><a class="dropdown-item" href="{{ url_for('main.contact') }}"><i class="fas fa-envelope"></i> Contact Support</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Settings</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="#" onclick="signOut()"><i class="fas fa-sign-out-alt"></i> Sign Out</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Profile Header -->
        <div class="profile-header">
            <div class="row">
                <div class="col-md-3 text-center">
                    <div class="profile-pic-container">
                        <img id="profile-pic" src="https://via.placeholder.com/200x200/6c757d/ffffff?text=Profile+Pic" 
                             alt="Profile Picture" class="profile-pic">
                        <button class="change-pic-btn" onclick="document.getElementById('profile-pic-input').click()">
                            <i class="fas fa-camera"></i>
                        </button>
                        <input type="file" id="profile-pic-input" accept="image/*" style="display: none;" 
                               onchange="changeProfilePic(this)">
                    </div>
                </div>
                <div class="col-md-9">
                    <div class="profile-info">
                        <h1 id="researcher-name">Dr. Jane Smith</h1>
                        <p class="title" id="researcher-title">Associate Professor of Computer Science</p>
                        <p class="institution" id="researcher-institution">University of Technology</p>
                        <p class="bio" id="researcher-bio">Leading researcher in artificial intelligence and machine learning with over 15 years of experience in developing innovative algorithms for data analysis.</p>
                        
                        <!-- Social Media Links -->
                        <div class="social-links">
                            <a href="#" class="social-link linkedin" id="linkedin-link">
                                <i class="fab fa-linkedin"></i> LinkedIn
                            </a>
                            <a href="#" class="social-link twitter" id="twitter-link">
                                <i class="fab fa-twitter"></i> Twitter
                            </a>
                            <a href="#" class="social-link instagram" id="instagram-link">
                                <i class="fab fa-instagram"></i> Instagram
                            </a>
                            <a href="#" class="social-link github" id="github-link">
                                <i class="fab fa-github"></i> GitHub
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Actions -->
        <div class="profile-actions">
            <button class="btn btn-primary" onclick="editProfile()">
                <i class="fas fa-edit"></i> Edit Profile
            </button>
            <button class="btn btn-success" onclick="addNewPaper()">
                <i class="fas fa-plus"></i> Add New Paper
            </button>
            <button class="btn btn-info" onclick="managePapers()">
                <i class="fas fa-file-alt"></i> Manage Papers
            </button>
        </div>

        <!-- Statistics -->
        <div class="stats-section">
            <div class="row">
                <div class="col-md-3">
                    <div class="stat-card">
                        <div class="stat-number" id="papers-count">24</div>
                        <div class="stat-label">Papers Published</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card">
                        <div class="stat-number" id="citations-count">1,247</div>
                        <div class="stat-label">Citations</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card">
                        <div class="stat-number" id="h-index">18</div>
                        <div class="stat-label">H-Index</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card">
                        <div class="stat-number" id="views-count">5,892</div>
                        <div class="stat-label">Profile Views</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Papers -->
        <div class="papers-section">
            <div class="section-header">
                <h2>Recent Papers</h2>
                <button class="btn btn-outline-primary btn-sm" onclick="viewAllPapers()">View All</button>
            </div>
            <div class="papers-grid" id="recent-papers">
                <!-- Papers will be dynamically loaded here -->
            </div>
        </div>

        <!-- Research Interests -->
        <div class="interests-section">
            <div class="section-header">
                <h2>Research Interests</h2>
                <button class="btn btn-outline-primary btn-sm" onclick="editInterests()">Edit</button>
            </div>
            <div class="interests-tags" id="research-interests">
                <span class="interest-tag">Machine Learning</span>
                <span class="interest-tag">Artificial Intelligence</span>
                <span class="interest-tag">Data Science</span>
                <span class="interest-tag">Neural Networks</span>
                <span class="interest-tag">Computer Vision</span>
            </div>
        </div>
        
        <!-- Logout Section -->
        <div class="logout-section text-center py-4">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-md-6">
                        <div class="logout-card">
                            <h4 class="mb-3">Account Management</h4>
                            <p class="text-muted mb-4">Manage your account settings and logout when you're done.</p>
                            <button class="btn btn-danger btn-lg" onclick="signOut()">
                                <i class="fas fa-sign-out-alt me-2"></i>Sign Out
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Edit Profile Modal -->
    <div class="modal fade" id="editProfileModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Profile</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="edit-profile-form">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Full Name</label>
                                    <input type="text" class="form-control" id="edit-name" value="Dr. Jane Smith">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Title</label>
                                    <input type="text" class="form-control" id="edit-title" value="Associate Professor of Computer Science">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Institution</label>
                                    <input type="text" class="form-control" id="edit-institution" value="University of Technology">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">LinkedIn</label>
                                    <input type="url" class="form-control" id="edit-linkedin" placeholder="https://linkedin.com/in/...">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Twitter</label>
                                    <input type="url" class="form-control" id="edit-twitter" placeholder="https://twitter.com/...">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Instagram</label>
                                    <input type="url" class="form-control" id="edit-instagram" placeholder="https://instagram.com/...">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">GitHub</label>
                                    <input type="url" class="form-control" id="edit-github" placeholder="https://github.com/...">
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Bio</label>
                            <textarea class="form-control" id="edit-bio" rows="4">Leading researcher in artificial intelligence and machine learning with over 15 years of experience in developing innovative algorithms for data analysis.</textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveProfile()">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Paper Modal -->
    <div class="modal fade" id="addPaperModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Paper</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="add-paper-form">
                        <div class="mb-3">
                            <label class="form-label">Paper Title *</label>
                            <input type="text" class="form-control" id="paper-title" required>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Authors *</label>
                                    <input type="text" class="form-control" id="paper-authors" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Publication Year *</label>
                                    <input type="number" class="form-control" id="paper-year" min="1900" max="2030" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Journal/Conference</label>
                                    <input type="text" class="form-control" id="paper-venue">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">DOI</label>
                                    <input type="text" class="form-control" id="paper-doi" placeholder="10.1000/...">
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Abstract</label>
                            <textarea class="form-control" id="paper-abstract" rows="4"></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Keywords</label>
                            <input type="text" class="form-control" id="paper-keywords" placeholder="Separate with commas">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">PDF File</label>
                            <input type="file" class="form-control" id="paper-pdf" accept=".pdf">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="submitPaper()">Add Paper</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    
    <!-- Custom JavaScript -->
    <script>
        // Sample papers data
        const samplePapers = [
            {
                title: "Advanced Neural Network Architectures for Image Recognition",
                authors: "Smith, J., Johnson, A., Williams, B.",
                year: 2023,
                venue: "International Conference on Computer Vision",
                citations: 45,
                abstract: "This paper presents novel neural network architectures..."
            },
            {
                title: "Machine Learning Approaches to Big Data Analysis",
                authors: "Smith, J., Brown, C.",
                year: 2022,
                venue: "Journal of Machine Learning Research",
                citations: 32,
                abstract: "We explore various machine learning techniques..."
            },
            {
                title: "Deep Learning Applications in Natural Language Processing",
                authors: "Smith, J., Davis, E., Wilson, F.",
                year: 2021,
                venue: "Neural Information Processing Systems",
                citations: 67,
                abstract: "This research investigates the application of deep learning..."
            }
        ];

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadRecentPapers();
            updateStats();
        });

        // Load recent papers
        function loadRecentPapers() {
            const papersContainer = document.getElementById('recent-papers');
            papersContainer.innerHTML = '';
            
            samplePapers.forEach(paper => {
                const paperCard = createPaperCard(paper);
                papersContainer.appendChild(paperCard);
            });
        }

        // Create paper card
        function createPaperCard(paper) {
            const card = document.createElement('div');
            card.className = 'paper-card';
            card.innerHTML = `
                <h3>${paper.title}</h3>
                <p class="authors">${paper.authors}</p>
                <p class="venue">${paper.venue} (${paper.year})</p>
                <p class="citations"><i class="fas fa-quote-left"></i> ${paper.citations} citations</p>
                <p class="abstract">${paper.abstract}</p>
                <div class="paper-actions">
                    <button class="btn btn-sm btn-outline-primary">View Details</button>
                    <button class="btn btn-sm btn-outline-secondary">Download PDF</button>
                </div>
            `;
            return card;
        }

        // Update statistics
        function updateStats() {
            document.getElementById('papers-count').textContent = samplePapers.length;
            const totalCitations = samplePapers.reduce((sum, paper) => sum + paper.citations, 0);
            document.getElementById('citations-count').textContent = totalCitations.toLocaleString();
        }

        // Change profile picture
        function changeProfilePic(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('profile-pic').src = e.target.result;
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        // Edit profile
        function editProfile() {
            const modal = new bootstrap.Modal(document.getElementById('editProfileModal'));
            modal.show();
        }

        // Save profile changes
        function saveProfile() {
            const name = document.getElementById('edit-name').value;
            const title = document.getElementById('edit-title').value;
            const institution = document.getElementById('edit-institution').value;
            const bio = document.getElementById('edit-bio').value;
            const linkedin = document.getElementById('edit-linkedin').value;
            const twitter = document.getElementById('edit-twitter').value;
            const instagram = document.getElementById('edit-instagram').value;
            const github = document.getElementById('edit-github').value;

            // Update the profile display
            document.getElementById('researcher-name').textContent = name;
            document.getElementById('researcher-title').textContent = title;
            document.getElementById('researcher-institution').textContent = institution;
            document.getElementById('researcher-bio').textContent = bio;

            // Update social links
            if (linkedin) document.getElementById('linkedin-link').href = linkedin;
            if (twitter) document.getElementById('twitter-link').href = twitter;
            if (instagram) document.getElementById('instagram-link').href = instagram;
            if (github) document.getElementById('github-link').href = github;

            // Close modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('editProfileModal'));
            modal.hide();

            // Show success message
            showNotification('Profile updated successfully!', 'success');
        }

        // Add new paper
        function addNewPaper() {
            const modal = new bootstrap.Modal(document.getElementById('addPaperModal'));
            modal.show();
        }

        // Submit paper
        function submitPaper() {
            const title = document.getElementById('paper-title').value;
            const authors = document.getElementById('paper-authors').value;
            const year = document.getElementById('paper-year').value;
            const venue = document.getElementById('paper-venue').value;
            const doi = document.getElementById('paper-doi').value;
            const abstract = document.getElementById('paper-abstract').value;
            const keywords = document.getElementById('paper-keywords').value;

            if (!title || !authors || !year) {
                showNotification('Please fill in all required fields.', 'error');
                return;
            }

            // Create new paper object
            const newPaper = {
                title: title,
                authors: authors,
                year: parseInt(year),
                venue: venue,
                doi: doi,
                abstract: abstract,
                keywords: keywords,
                citations: 0
            };

            // Add to papers array
            samplePapers.unshift(newPaper);

            // Reload papers and update stats
            loadRecentPapers();
            updateStats();

            // Close modal and reset form
            const modal = bootstrap.Modal.getInstance(document.getElementById('addPaperModal'));
            modal.hide();
            document.getElementById('add-paper-form').reset();

            showNotification('Paper added successfully!', 'success');
        }

        // Manage papers
        function managePapers() {
            showNotification('Paper management feature coming soon!', 'info');
        }

        // View all papers
        function viewAllPapers() {
            showNotification('Full papers list coming soon!', 'info');
        }

        // Edit interests
        function editInterests() {
            showNotification('Interest editing feature coming soon!', 'info');
        }

        // Show notification
        function showNotification(message, type) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;

            // Add to page
            document.body.appendChild(notification);

            // Show notification
            setTimeout(() => notification.classList.add('show'), 100);

            // Remove after 3 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Check authentication status
        function checkAuthStatus() {
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            const username = localStorage.getItem('username') || 'User';
            
            if (isLoggedIn) {
                document.getElementById('auth-buttons').classList.add('d-none');
                document.getElementById('user-menu').classList.remove('d-none');
                document.getElementById('username').textContent = username;
            } else {
                document.getElementById('auth-buttons').classList.remove('d-none');
                document.getElementById('user-menu').classList.add('d-none');
            }
        }

        // Sign out function
        function signOut() {
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('username');
            window.location.href = "{{ url_for('main.home') }}";
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
        });
    </script>

    <!-- Footer -->
    <footer class="footer mt-auto py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>Research'D</h5>
                    <p class="text-muted">Connecting researchers and fostering academic collaboration worldwide.</p>
                </div>
                <div class="col-md-3">
                    <h6>Quick Links</h6>
                    <ul class="list-unstyled">
                        <li><a href="{{ url_for('main.home') }}" class="text-muted">Home</a></li>
                        <li><a href="{{ url_for('main.search') }}" class="text-muted">Search</a></li>
                        <li><a href="{{ url_for('main.profile') }}" class="text-muted">Profile</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h6>Support</h6>
                    <ul class="list-unstyled">
                        <li><a href="{{ url_for('main.help') }}" class="text-muted">Help Centre</a></li>
                        <li><a href="{{ url_for('main.contact') }}" class="text-muted">Contact Us</a></li>
                        <li><a href="{{ url_for('main.privacy') }}" class="text-muted">Privacy Policy</a></li>
                    </ul>
                </div>
            </div>
            <hr>
            <div class="text-center">
                <p class="text-muted mb-0">&copy; 2025 Research'D. All rights reserved.</p>
            </div>
        </div>
    </footer>
</body>
</html>
